{% load staticfiles %}

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Photo Sharing App</title>
</head>
<body>

{% if messages %}
    {% for message in messages %}
        <p{% if message.tags %} class="{{ message.tags }}"{% endif %}>{{ message }}</p>
    {% endfor %}
{% endif %}

{% for post in posts %}

    <h3><a href="/photos/{{ post.user.email_address }}"> {{ post.user.name }} </a></h3>
    <p>[{{ post.created_on }}]</p>
    <img style="display:inline-block; width:350px; height:300px;"
         src="{{ post.image.url }}"/><br>
    <span style="display:inline-block;">{{ post.caption }}</span><br/><br/>

    <div style="display:inline-block">
        {% if post.like_count == 1 %}
            <a href="/photos/likes/{{ post.id }}"> {{ post.like_count }} </a> likes this
        {% elif post.like_count > 1 %}
            <a href="/photos/likes/{{ post.id }}"> {{ post.like_count }} </a> like this
        {% endif %}
    </div>

    <div style="display:inline-block">
        <form method="POST" action="/photos/like">
            {% csrf_token %}
            <input type="hidden" name="post" value="{{ post.id }}"/>
            {% if post.has_liked %}
                <input type="submit" class="btn btn-default" value="Unlike">
            {% else %}
                <input type="submit" class="btn btn-default" value="Like">
            {% endif %}
        </form>
    </div>

    <div>
        <p> Tags: </p>
        {% for category in post.categories %}
            <span> <a href="/photos/tag/{{ category.category_text }}"> {{ category.category_text }} </a> </span>
        {% endfor %}
    </div>

    <div>
        <form method="POST" action="/photos/comment">
            {% csrf_token %}
            <input type="hidden" name="post" value="{{ post.id }}"/>
            <input type="text" name="comment_text" id="comment_text" placeholder="Make a comment.."
                   value="{{ comment_text }}">
            {{ comment_text }}
            <input type="submit" class="btn-default btn" value="Comment">
        </form>
    </div>

    <div>
        {% for comment in post.comments %}
            <p><b><a href="/photos/{{ post.user.email_address }}">{{ comment.user.name }}</a> [{{ comment.created_on }}]:</b> {{ comment.comment_text }}</p>
        {% endfor %}
    </div>

{% endfor %}
</body>
</html>